
---

# 项目 API 接口文档

## 1. 通用说明
*   **基础路径**: `/api`
*   **认证方式**: 除注册和登录外，其余接口需在请求头（Header）中携带 Token。
    *   `Authorization: [Your_Token_Here]`
*   **日期格式**: 
    *   任务/子任务时间: `yyyy-MM-dd HH:mm` (例如: `2023-10-27 10:00`)
    *   系统记录时间 (创建/更新): `yyyy-MM-dd HH:mm:ss`

---

## 2. 数据对象定义 (Data Models)

### User (用户)
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | Long | 用户ID |
| username | String | 用户名 (唯一) |
| nickname | String | 昵称 |
| avatar | String | 头像地址或Base64 |
| theme | String | 主题枚举: `LIGHT`, `DARK`, `PROTECTED` |

### Task (任务)
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | Long | 任务ID |
| title | String | 标题 |
| description | String | 描述 |
| status | String | 状态 (如: `TODO`, `DONE`) |
| startTime | String | 开始时间 (`yyyy-MM-dd HH:mm`) |
| endTime | String | 结束时间 (`yyyy-MM-dd HH:mm`) |
| createdAt | String | 创建时间 (后端自动生成) |
| updatedAt | String | 最后更新时间 (后端自动生成) |
| priority | String | 优先级 (如: `低`, `中`, `高`, `紧急`) |
| taskType | String | 类型 (`短期`, `长期`) |
| subTasks | Array | 子任务列表 |

### SubTask (子任务)
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | Long | 子任务ID |
| title | String | 标题 |
| description | String | 描述 |
| startTime | String | 开始时间 |
| endTime | String | 结束时间 |
| isDone | Boolean | 是否完成 |

---

## 3. 认证接口 (AuthController)

### 3.1 用户注册
*   **URL**: `/api/auth/register`
*   **Method**: `POST`
*   **Body**:
```json
{
  "username": "testuser",
  "password": "password123",
  "nickname": "小明",
  "avatar": "url_to_avatar"
}
```

### 3.2 用户登录
*   **URL**: `/api/auth/login`
*   **Method**: `POST`
*   **Body**:
```json
{
  "username": "testuser",
  "password": "password123"
}
```
*   **返回**: `{"token": "xxxxxx"}`

---

## 4. 用户信息接口 (UserController)

### 4.1 获取当前用户信息
*   **URL**: `/api/user/info`
*   **Method**: `GET`
*   **返回**: User对象

### 4.2 修改个人资料
*   **URL**: `/api/user/profile`
*   **Method**: `PUT`
*   **Body** (可选字段):
```json
{
  "nickname": "新的昵称",
  "avatar": "新头像地址",
  "theme": "DARK" 
}
```
> **注意**: `theme` 只能取值 `LIGHT`, `DARK`, `PROTECTED`。

---

## 5. 任务管理接口 (TaskController)

### 5.1 获取当前用户所有任务
*   **URL**: `/api/tasks`
*   **Method**: `GET`
*   **返回**: `Task[]` (包含创建时间和更新时间)

### 5.2 创建新任务
*   **URL**: `/api/tasks`
*   **Method**: `POST`
*   **Body**:
```json
{
  "title": "学习Spring Boot",
  "description": "完成API文档编写",
  "status": "TODO",
  "startTime": "2023-10-27 09:00",
  "endTime": "2023-10-27 18:00",
  "priority": "高",
  "taskType": "短期",
  "subTasks": [
    {
      "title": "子任务1",
      "description": "子描述",
      "startTime": "2023-10-27 09:00",
      "endTime": "2023-10-27 10:00",
      "isDone": false
    }
  ]
}
```

### 5.3 更新任务
*   **URL**: `/api/tasks/{id}`
*   **Method**: `PUT`
*   **Body**: 同创建任务

### 5.4 删除任务
*   **URL**: `/api/tasks/{id}`
*   **Method**: `DELETE`

---

## 6. 业务规则提示 (前端校验参考)
1.  **时间限制**: `endTime` 必须晚于 `startTime`。
2.  **短期任务限制**: 若 `taskType` 为 `"短期"`，则开始时间与结束时间的间隔不能超过 **24小时**。
3.  **强制字段**: 创建任务时，`startTime` 和 `endTime` 不能为空。
4.  **枚举约束**: 修改主题时，请务必发送 `LIGHT`、`DARK` 或 `PROTECTED` 字符串（不区分大小写，后端会自动转换）。